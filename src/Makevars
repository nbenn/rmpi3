
# OpenMPI header and libraries
MPICPPFLAGS=$(shell mpicxx -showme:compile)
MPILIBS=$(shell mpicxx -showme:link)

PKG_CPPFLAGS=$(MPICPPFLAGS)
PKG_LIBS=$(MPILIBS)

RINSIDELIBS=$(shell echo 'RInside:::LdFlags()' | $(R_HOME)/bin/R --vanilla --slave)

.PHONY: all print_vars

all: $(SHLIB) print_vars worker/runner

worker/runner: worker/runner.cpp
	$(CXX) $(ALL_CPPFLAGS) $< $(RINSIDELIBS) $(ALL_LIBS) -o $@

print_vars:
	@echo $(CXX)
	@echo $(ALL_CPPFLAGS)
	@echo $(ALL_LIBS)
	@echo $(RINSIDELIBS)
